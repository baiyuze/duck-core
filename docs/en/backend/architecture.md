# Backend Architecture

This document outlines the architecture of the backend service.

## Project Structure

The backend is a Go project with a layered architecture. Here's a breakdown of the key directories:

-   **/config**: Contains configuration files for different environments (development, production) and the logic to load them.
-   **/docs**: API documentation generated by Swagger.
-   **/internal**: This is where the core application logic resides, separated into different concerns.
    -   **/common**: Shared utilities like error handling, JWT, and logging.
    -   **/di**: Dependency injection container setup.
    -   **/dto**: Data Transfer Objects used for API requests and responses.
    -   **/grpc**: gRPC server implementation, including protocol definitions (`.proto`), generated code, and handlers.
    -   **/handler**: HTTP handlers that process incoming requests, interact with services, and return responses.
    -   **/middleware**: HTTP middleware for concerns like JWT authentication, logging, and recovery.
    -   **/model**: Database models representing the application's data structures.
    -   **/repo**: Database repository layer for data access and migrations.
    -   **/router**: Defines the HTTP routes and maps them to their respective handlers.
    -   **/service**: Business logic layer, containing the core functionality of the application.
-   **/utils**: General utility functions.
-   **main.go**: The entry point of the application.
-   **go.mod**, **go.sum**: Go module files for dependency management.
-   **docker-compose.yml**: Docker Compose file for setting up the development environment.

## Layers

1.  **Router Layer** (`internal/router`): Defines the API endpoints and forwards requests to the handler layer.
2.  **Middleware Layer** (`internal/middleware`): Intercepts requests to perform cross-cutting concerns like authentication, logging, and tracing.
3.  **Handler Layer** (`internal/handler`): Receives requests from the router, validates input (DTOs), calls the appropriate service, and formats the response.
4.  **Service Layer** (`internal/service`): Contains the core business logic. It orchestrates data from different repositories and performs the main operations.
5.  **Repository Layer** (`internal/repo`): Interacts with the `database`. It's responsible for all database operations (CRUD) and data migrations.
6.  **Model Layer** (`internal/model`): Defines the data structures that map to database tables.

## gRPC

The backend also exposes a gRPC server for inter-service communication. The gRPC definitions are located in `internal/grpc/proto`. The implementation of the gRPC server, clients, and handlers are in the `internal/grpc` directory.
