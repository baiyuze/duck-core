<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>Bezier Curve Icons on Canvas</title>
    <style>
        #myCanvas {
            border: 1px solid #ccc;
            background-color: #f9f9f9;
        }
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        h2 {
            margin-bottom: 5px;
        }
    </style>
</head>
<body>

    <h2>二次和三次贝塞尔曲线图标示例 (Canvas)</h2>
    <canvas id="myCanvas" width="450" height="200"></canvas>

    <script>
        const canvas = document.getElementById('myCanvas');
        const ctx = canvas.getContext('2d');

        // JSON 数据结构
        const shapeData = [
            // ===============================================
            // 1. 二次贝塞尔曲线 (Q) 图标 - 位于左侧
            // ===============================================
            // 1.1 头部 (Head) - 椭圆形 (Q)
            {
                "id": "101",
                "type": "ellipse",
                "position": { "x": 100, "y": 100 },
                "size": { "width": 40, "height": 50 },
                "rx": 20,
                "ry": 25,
                "color": { "fillColor": "#666666", "strokeColor": "" },
                "selected": { "value": false },
                "scale": { "value": 1 }
            },
            // 1.2 身体/肩部 (Body) - 使用二次贝塞尔曲线 (Q)
            {
                "id": "102",
                "type": "polygon",
                "position": { "x": 60, "y": 125 },
                "size": { "width": 80, "height": 40 },
                "color": { "fillColor": "#666666", "strokeColor": "" },
                "selected": { "value": false },
                "scale": { "value": 1 },
                "polygon": {
                    "vertexs": [
                        { "type": "M", "point": { "x": 0, "y": 20 } },
                        { "type": "L", "point": { "x": 0, "y": 40 } },
                        { "type": "L", "point": { "x": 80, "y": 40 } },
                        { "type": "L", "point": { "x": 80, "y": 20 } },
                        // Q: 右侧颈部弧线
                        { "type": "Q", "controlPoint": { "x": 65, "y": 10 }, "endPoint": { "x": 40, "y": 20 } },
                        // Q: 左侧颈部弧线 (连接回起点)
                        { "type": "Q", "controlPoint": { "x": 15, "y": 10 }, "endPoint": { "x": 0, "y": 20 } }
                    ]
                }
            },
            
            // ===============================================
            // 2. 三次贝塞尔曲线 (C) 图标 - 位于右侧
            // ===============================================

            // 2.1 头部 (Head) - 椭圆形 (C)
            {
                "id": "201",
                "type": "ellipse",
                "position": { "x": 350, "y": 100 }, // 调整 x 坐标以拉开间距
                "size": { "width": 40, "height": 50 },
                "rx": 20,
                "ry": 25,
                "color": { "fillColor": "#666666", "strokeColor": "" },
                "selected": { "value": false },
                "scale": { "value": 1 }
            },
            
            // 2.2 身体/肩部 (Body) - 使用三次贝塞尔曲线 (C)
            {
                "id": "202",
                "type": "polygon",
                "position": { "x": 310, "y": 125 }, // 调整 x 坐标以拉开间距 (350 - 40 = 310)
                "size": { "width": 80, "height": 40 },
                "color": { "fillColor": "#666666", "strokeColor": "" },
                "selected": { "value": false },
                "scale": { "value": 1 },
                "polygon": {
                    "vertexs": [
                        { "type": "M", "point": { "x": 0, "y": 20 } },
                        { "type": "L", "point": { "x": 0, "y": 40 } },
                        { "type": "L", "point": { "x": 80, "y": 40 } },
                        { "type": "L", "point": { "x": 80, "y": 20 } },
                        
                        // C: 右侧颈部弧线
                        {
                            "type": "C",
                            "startTangent": { "x": 75, "y": 10 },
                            "endTangent": { "x": 55, "y": 5 },
                            "endPoint": { "x": 40, "y": 20 }
                        },
                        
                        // C: 左侧颈部弧线 (连接回起点)
                        {
                            "type": "C",
                            "startTangent": { "x": 25, "y": 5 },
                            "endTangent": { "x": 5, "y": 10 },
                            "endPoint": { "x": 0, "y": 20 }
                        }
                    ]
                }
            }
        ];

        // 绘图函数
        function drawShapes() {
            shapeData.forEach(item => {
                ctx.beginPath();
                const { x, y } = item.position;
                const { fillColor, strokeColor } = item.color;
                
                ctx.fillStyle = fillColor || 'none';
                ctx.strokeStyle = strokeColor || 'none';

                if (item.type === 'ellipse') {
                    // 绘制椭圆形 (头部)
                    ctx.ellipse(
                        x, y,          // 中心点 (cx, cy)
                        item.rx, item.ry, // 半径 (rx, ry)
                        0,             // 旋转角度 (0)
                        0, 2 * Math.PI // 起始角和结束角 (完整圆)
                    );
                    ctx.fill();

                } else if (item.type === 'polygon' && item.polygon) {
                    // 绘制多边形/肩部
                    const vertexs = item.polygon.vertexs;

                    vertexs.forEach(v => {
                        // 将相对坐标转换为绝对坐标
                        const absX = x + (v.point ? v.point.x : 0);
                        const absY = y + (v.point ? v.point.y : 0);
                        
                        switch (v.type) {
                            case 'M': // MoveTo
                                ctx.moveTo(absX, absY);
                                break;
                            case 'L': // LineTo
                                ctx.lineTo(absX, absY);
                                break;
                            case 'Q': // Quadratic Bezier Curve (二次贝塞尔曲线)
                                const cpx = x + v.controlPoint.x;
                                const cpy = y + v.controlPoint.y;
                                ctx.quadraticCurveTo(cpx, cpy, absX, absY);
                                break;
                            case 'C': // Cubic Bezier Curve (三次贝塞尔曲线)
                                const cp1x = x + v.startTangent.x;
                                const cp1y = y + v.startTangent.y;
                                const cp2x = x + v.endTangent.x;
                                const cp2y = y + v.endTangent.y;
                                ctx.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, absX, absY);
                                break;
                        }
                    });

                    // 封闭路径并填充
                    ctx.closePath();
                    ctx.fill();
                }
            });
            
            // 添加文本标记，说明曲线类型
            ctx.fillStyle = "#333333";
            ctx.font = "14px Arial";
            ctx.fillText("二次贝塞尔 (Q) - 头部颈部使用 Q 曲线", 20, 185);
            ctx.fillText("三次贝塞尔 (C) - 头部颈部使用 C 曲线", 280, 185);
        }

        // 运行绘图
        drawShapes();
    </script>
</body>
</html>